#!/bin/bash
#=======================================================================
ind_ams=${1}
#=======================================================================
ind_lamb=${2}
#=======================================================================
num_base=1
#-----------------------------------------------------------------------
tam_rede=${num_base}000000
grau_rrn=6
#-----------------------------------------------------------------------
grauStar=998
#-----------------------------------------------------------------------
lamb0=0.18
#-----------------------------------------------------------------------
divisor=7
#-----------------------------------------------------------------------
alp=2.0
#-----------------------------------------------------------------------
n_lamb=500
#-----------------------------------------------------------------------
tRelax=1000000
#-----------------------------------------------------------------------
tTotal=4000000
#-----------------------------------------------------------------------
interpola=-1           # 0, continua; 1, dlb/2; 2, 1.0*dlb/4
                       # 3, 3 * dlb/4; 4, 1.0*dlb/3
                       # 5, 2 * dlb/3; -1, aceita o lamb0 dado aqui

Eh_Limiar=1            # 0, se ponto ordinario, 1 se limiar
#=======================================================================
maquina='cluster'
#maquina='casa'
#=======================================================================
#flags='-check all -traceback'
#-----------------------------------------------------------------------
#flags='-heap-arrays -O3 -g -fp-stack-check'
#-----------------------------------------------------------------------
#flags='-traceback -check all -heap-arrays -O3 -g -fp-stack-check'
#-----------------------------------------------------------------------
flags=''
#=======================================================================
dependencias='mod_rndgen_multiple.f90 geraRede.f90 mod_tools_redes.f90'
principal='main_SIRS_Estocastico_grafoRRN_Plus_Star.f90'
#=======================================================================
nzeros=$( echo "scale=0; l(${tam_rede}/${num_base})/l(10) " | bc -l)
#=======================================================================
IFS='.'
#=======================================================================
alp_arr=( ${alp} )
#=======================================================================
IFS=' '
#=======================================================================
executavel='rrn_t'${num_base}${nzeros}'k'${grau_rrn}'a'${alp_arr[0]}'p'${alp_arr[1]}'ams'${ind_ams}_indLBD_${ind_lamb}
#=======================================================================
#================= Aqui deletamos o antigo executavel ==================
rm ${executavel} > erroRmExe.log
#=======================================================================
ifort ${dependencias} ${principal} ${flags} -o ${executavel}
#=======================================================================
rm -r *.mod
#=======================================================================
if [[ ${maquina} == 'casa' ]];then
   #--------------------------------------------------------------------
   time ./${executavel} ${tam_rede} ${grau_rrn} ${lamb0} ${divisor} ${alp} ${n_lamb} ${tTotal} ${tRelax} ${interpola} ${grauStar} ${ind_lamb} ${Eh_Limiar}
   #--------------------------------------------------------------------
elif [[ ${maquina} == 'cluster' ]];then
   #--------------------------------------------------------------------
   qsub -N ${executavel} -cwd executa_sirs_est_grafoRRN_Plus_Star.sh ${executavel} ${tam_rede} ${grau_rrn} ${lamb0} ${divisor} ${alp} ${n_lamb} ${tTotal} ${tRelax} ${interpola} ${grauStar} ${ind_lamb} ${Eh_Limiar}
   #--------------------------------------------------------------------
else
   #--------------------------------------------------------------------
   echo "Maquina nao-reconhecida. Abortando script..."
   #--------------------------------------------------------------------
   exit
fi
#=======================================================================
